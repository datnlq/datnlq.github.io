<!doctype html>
<html lang="en-us">
  <head>
    <title>AccessControl // DatNLQ</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.88.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="DatNLQ" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="https://datnlq.github.io/css/main.min.4a7ec8660f9a44b08c4da97c5f2e31b1192df1d4d0322e65c0dbbc6ecb1b863f.css" />

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="AccessControl"/>
<meta name="twitter:description" content="Access Control Vulnerabilities ChÃ o má»i ngÆ°á»i ~ MÃ¬nh Ä‘Ã£ dá»«ng viá»‡c traning trÃªn portswigger 1 thá»i gian khÃ¡ dÃ i, maybe do mÃ¬nh chÆ¡i Ä‘á»“ (Ã¡n) nhiá»u quÃ¡ :3 NhÆ°ng dÃ¹ sao mÃ¬nh khÃ´ng nÃªn bá» bÃª chá»©ng chá»‰ web nÃ y Ä‘Æ°á»£c :D. HÃ´m nay chÃºng ta sáº½ mÃ´ táº£ vá» lá»— há»•ng kiá»ƒm soÃ¡t truy cáº­p(Access control) vÃ  leo thang Ä‘áº·c quyá»n (Privilege escalation) nhÃ©! Äá»ƒ cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c báº¥t ká»³ lá»— há»•ng nÃ o thÃ¬ chÃºng ta Ä‘á»u pháº£i biáº¿t nÃ³ lÃ  lá»— há»•ng gÃ¬ trÆ°á»›c nÃªn chÃºng ta sáº½ tÃ¬m hiá»ƒu qua khÃ¡i niá»‡m cá»§a 2 lá»— há»•ng nÃ y trÆ°á»›c"/>

    <meta property="og:title" content="AccessControl" />
<meta property="og:description" content="Access Control Vulnerabilities ChÃ o má»i ngÆ°á»i ~ MÃ¬nh Ä‘Ã£ dá»«ng viá»‡c traning trÃªn portswigger 1 thá»i gian khÃ¡ dÃ i, maybe do mÃ¬nh chÆ¡i Ä‘á»“ (Ã¡n) nhiá»u quÃ¡ :3 NhÆ°ng dÃ¹ sao mÃ¬nh khÃ´ng nÃªn bá» bÃª chá»©ng chá»‰ web nÃ y Ä‘Æ°á»£c :D. HÃ´m nay chÃºng ta sáº½ mÃ´ táº£ vá» lá»— há»•ng kiá»ƒm soÃ¡t truy cáº­p(Access control) vÃ  leo thang Ä‘áº·c quyá»n (Privilege escalation) nhÃ©! Äá»ƒ cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c báº¥t ká»³ lá»— há»•ng nÃ o thÃ¬ chÃºng ta Ä‘á»u pháº£i biáº¿t nÃ³ lÃ  lá»— há»•ng gÃ¬ trÆ°á»›c nÃªn chÃºng ta sáº½ tÃ¬m hiá»ƒu qua khÃ¡i niá»‡m cá»§a 2 lá»— há»•ng nÃ y trÆ°á»›c" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://datnlq.github.io/posts/accesscontrol/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-07T04:03:51+07:00" />
<meta property="article:modified_time" content="2021-11-07T04:03:51+07:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://datnlq.github.io/"><img class="app-header-avatar" src="/avatar.jpg" alt="DatNLQ" /></a>
      <h1>DatNLQ</h1>
      <p>DatNLQ&#39;s personal website</p>
      <div class="app-header-social">
        
          <a href="https://github.com/datnlq" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>My Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">AccessControl</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Nov 7, 2021
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          18 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="access-control-vulnerabilities">Access Control Vulnerabilities</h1>
<p>ChÃ o má»i ngÆ°á»i ~ MÃ¬nh Ä‘Ã£ dá»«ng viá»‡c traning trÃªn portswigger 1 thá»i gian khÃ¡ dÃ i, maybe do mÃ¬nh chÆ¡i Ä‘á»“ (Ã¡n) nhiá»u quÃ¡ :3 NhÆ°ng dÃ¹ sao mÃ¬nh khÃ´ng nÃªn bá» bÃª chá»©ng chá»‰ web nÃ y Ä‘Æ°á»£c :D.
HÃ´m nay chÃºng ta sáº½ mÃ´ táº£ vá» lá»— há»•ng kiá»ƒm soÃ¡t truy cáº­p(Access control) vÃ  leo thang Ä‘áº·c quyá»n (Privilege escalation) nhÃ©!
Äá»ƒ cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c báº¥t ká»³ lá»— há»•ng nÃ o thÃ¬ chÃºng ta Ä‘á»u pháº£i biáº¿t nÃ³ lÃ  lá»— há»•ng gÃ¬ trÆ°á»›c nÃªn chÃºng ta sáº½ tÃ¬m hiá»ƒu qua khÃ¡i niá»‡m cá»§a 2 lá»— há»•ng nÃ y trÆ°á»›c</p>
<h3 id="what-is-access-control-">What is access control ?</h3>
<p>Access control ( authorization &lt;á»§y quyá»n&gt;) lÃ  cáº¥p quyá»n, á»§y quyá»n, Ã¡p dá»¥ng cÃ¡c rÃ ng buá»™c vá» ai Ä‘Ã³ hoáº·c gÃ¬ Ä‘Ã³ Ä‘á»ƒ cÃ³ thá»ƒ thá»±c hiá»‡n cÃ¡c hÃ nh Ä‘á»™ng hoáº·c truy cáº­p cÃ¡c tÃ i nguyÃªn.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Accessctl_lythuyet.png?raw=true" alt="img"></p>
<p>Trong web app thÃ¬ cÃ³ cÃ¡c ngá»¯ cáº£nh kiá»ƒm soÃ¡t truy cáº­p nhÆ° sau :</p>
<ul>
<li>Authentication : XÃ¡c thá»±c ngÆ°á»i dÃ¹ng chÃ­nh lÃ  há»</li>
<li>Session management xÃ¡c Ä‘á»‹nh cÃ¡c yÃªu cáº§u HTTP tiáº¿p theo Ä‘Æ°á»£c cho phÃ©p thá»±c hiá»‡n bá»Ÿi chÃ­nh ngÆ°á»i dÃ¹ng</li>
<li>Access control xÃ¡c Ä‘á»‹nh liá»‡u ngÆ°á»i dÃ¹ng cÃ³ Ä‘Æ°á»£c phÃ©p thá»±c hiá»‡n hÃ nh Ä‘á»™ng hoáº·c truy cáº­p Ä‘Ã³ hay khÃ´ng.</li>
</ul>
<p>Lá»— há»•ng kiá»ƒm soÃ¡t truy cáº­p lÃ  1 lá»— há»•ng thÆ°á»ng gáº·p vÃ  khÃ¡ nghiÃªm trá»ng. Viá»‡c thiáº¿t káº¿, quáº£n lÃ½ cÃ¡c biá»‡n phÃ¡p kiá»ƒm soÃ¡t quyá»n truy cáº­p lÃ  má»™t váº¥n Ä‘á» phá»©c táº¡p. MÃ  mÃ´ hÃ¬nh nÃ y Ä‘Æ°á»£c thiáº¿t káº¿ bá»Ÿi con ngÆ°á»i cho nÃªn kháº£ nÄƒng xáº£y ra sai sÃ³t lÃ  ráº¥t cao.</p>
<p>Viá»‡c hacker táº¥n cÃ´ng vÃ o lá»— há»•ng nÃ y Ä‘Æ°á»£c chia lÃ m 2 loáº¡i nhÆ° sau Ä‘Æ°á»£c Ä‘á» cáº­p Ä‘áº¿n trong Top 10 lá»— há»•ng báº£o máº­t web cá»§a OWASP-2017</p>
<h4 id="broken-authentication-and-session-management">Broken Authentication and Session Management</h4>
<p>Khi cÃ¡c chá»©c nÄƒng cá»§a á»©ng dá»¥ng Ä‘Æ°á»£c thá»±c hiá»‡n khÃ´ng chÃ­nh xÃ¡c, hacker cÃ³ thá»ƒ dá»… dÃ ng xÃ¢m nháº­p, Ä‘Ã¡nh cáº¯p
thÃ´ng tin tÃ i khoáº£n, máº­t kháº©u vÃ  khai thÃ¡c cÃ¡c lá»— há»•ng khÃ¡c báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c chá»©ng chá»‰ Ä‘Ã£ Ä‘Ã¡nh cáº¯p.
TÃ i khoáº£n má»—i ngÆ°á»i dÃ¹ng cÃ¡ nhÃ¢n nÃªn lÃ  duy nháº¥t, khÃ´ng bá»‹ trÃ¹ng láº·p dÆ°á»›i báº¥t kÃ¬ hÃ¬nh thá»©c nÃ o.
Náº¿u khÃ´ng cÃ³ báº¥t kÃ¬ sá»± quáº£n lÃ½ cáº§n thiáº¿t nÃ o thÃ¬ tin táº·c cÃ³ thá»ƒ láº»n vÃ o, ngá»¥y trang thÃ nh ngÆ°á»i dÃ¹ng Ä‘á»ƒ
Äƒn cáº¯p thÃ´ng tin tÃ i khoáº£n, máº­t kháº©u vÃ  sá»­ dá»¥ng cho nhá»¯ng láº§n truy cáº­p sau nÃ y.</p>
<h4 id="broken-access-control">Broken Access Control</h4>
<p>Khi ngÆ°á»i dÃ¹ng bá»‹ háº¡n cháº¿ kiá»ƒm soÃ¡t truy cáº­p, hacker cÃ³ thá»ƒ khai thÃ¡c vÃ  truy cáº­p cÃ¡c chá»©c nÄƒng hoáº·c dá»¯
liá»‡u trÃ¡i phÃ©p. Kiá»ƒm soÃ¡t truy cáº­p nháº±m má»¥c Ä‘Ã­ch kiá»ƒm soÃ¡t ngÆ°á»i dÃ¹ng trong má»™t á»©ng dá»¥ng vÃ  Ä‘á»ƒ thiáº¿t láº­p
quyá»n kiá»ƒm soÃ¡t truy cáº­p má»™t cÃ¡ch há»£p lÃ½, á»©ng dá»¥ng pháº£i Ä‘áº£m báº£o thá»±c hiá»‡n kiá»ƒm tra á»§y quyá»n, phÃ¢n quyá»n vÃ 
xÃ¡c thá»±c há»£p lá»‡ Ä‘á»ƒ xÃ¡c Ä‘á»‹nh rÃµ rÃ ng Ä‘áº·c quyá»n cá»§a ngÆ°á»i dÃ¹ng. NguyÃªn nhÃ¢n dáº«n Ä‘áº¿n lá»—i nÃ y cÃ³ thá»ƒ do cÃ¡c nhÃ  phÃ¡t triá»ƒn
gáº·p lá»—i trong quÃ¡ trÃ¬nh phÃ¢n quyá»n vÃ  kiá»ƒm soÃ¡t yÃªu cáº§u phÃ¹ há»£p vá»›i cÃ¡c quy táº¯c Ä‘áº·t ra, hoáº·c cÃ³ thá»ƒ do an ninh lá»ng láº»o táº¡i cÃ¡c táº§ng kiáº¿n trÃºc cá»§a web nhÆ°
framework, server, serverdata, &hellip;nÃªn hacker cÃ³ thá»ƒ lá»£i dá»¥ng vÃ  táº¥n cÃ´ng láº¥y quyá»n truy cáº­p.</p>
<h3 id="what-is-privilege-escalation-">What is Privilege escalation ?</h3>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Accessctl_Privilege_lythuyet.png?raw=true" alt="img"></p>
<p>Privilege escalation ( leo thang Ä‘áº·c quyá»n) xáº£y ra khi báº¡n cÃ³ thá»ƒ truy cáº­p nhá»¯ng chá»©c nÄƒng hoáº·c tÃ i nguyÃªn mÃ  báº¡n khÃ´ng Ä‘Æ°á»£c cho phÃ©p, viá»‡c leo thang Ä‘áº·c quyá»n nÃ y cáº§n pháº£i Ä‘Æ°á»£c ngÄƒn cháº·n. Leo thang Ä‘áº·c quyá»n thÆ°á»ng xuáº¥t hiá»‡n do 1 lá»— há»•ng trong á»©ng dá»¥ng gÃ¢y ra.
Má»©c Ä‘á»™ leo thang tÃ¹y thuá»™c vÃ o nhá»¯ng Ä‘áº·c quyá»n mÃ  hacker cÃ³ Ä‘Æ°á»£c dá»±a vÃ o khai thÃ¡c lá»— há»•ng.</p>
<h3 id="the-impacts-of-broken-access-control">The Impacts of Broken Access Control</h3>
<p>NhÆ° Ä‘Ã£ Ä‘á» cáº­p Ä‘áº¿n, má»©c Ä‘á»™ cá»§a lá»— há»•ng nÃ y tÃ¹y thuá»™c vÃ o dá»¯ liá»‡u mÃ  hacker cÃ³ thá»ƒ khai thÃ¡c Ä‘Æ°á»£c. Má»™t sá»‘ hÃ nh vi Ä‘áº·c trÆ°ng nhÆ° sau :</p>
<h6 id="exposure-of-unauthorized-content-hiá»ƒn-thá»‹-ná»•i-dung-trÃ¡i-phÃ©p">Exposure of Unauthorized Content (Hiá»ƒn thá»‹ ná»•i dung trÃ¡i phÃ©p)</h6>
<p>Khi hacker Ä‘Ã£ cÃ³ Ä‘áº·c quyá»n truy cáº­p trÃ¡i phÃ©p thÃ¬ sáº½ cÃ³ thá»ƒ tiáº¿p cáº­n tá»›i nhiá»u tÃ i nguyÃªn khÃ´ng Ä‘Æ°á»£c phÃ©p, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  hacker sáº½ cÃ³ thá»ƒ truy cáº­p, tÃ¡c Ä‘á»™ng lÃªn nhá»¯ng thÃ´ng tin nháº¡y cáº£m cá»§a cÃ´ng ty.</p>
<h6 id="privilege-escalation-leo-thang-Ä‘áº·c-quyá»n">Privilege Escalation (Leo thang Ä‘áº·c quyá»n)</h6>
<p>Hacker khai thÃ¡c cÃ¡c lá»— há»•ng Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c Ä‘áº·c quyá»n cao hÆ¡n Ä‘áº·c quyá»n hiá»‡n cÃ³ cá»§a mÃ¬nh, viá»‡c nÃ y cÃ³ thá»ƒ giÃºp hacker dá»… dÃ ng Ä‘Ã¡nh cáº¯p dá»¯ liá»‡u hoáº·c triá»ƒn khai cÃ¡c payload Ä‘á»™c háº¡i.</p>
<h6 id="distributed-denial-of-service--tá»«-chá»‘i-dá»‹ch-vá»¥-ddos">Distributed Denial of Service ( Tá»« chá»‘i dá»‹ch vá»¥ <!-- raw HTML omitted -->)</h6>
<p>Viá»‡c quyá»n truy cáº­p vÃ o nhiá»u tÃ i khoáº£n, hacker cÃ³ thá»ƒ triá»ƒn khai táº¥n cÃ´ng báº±ng cÃ¡ch setup bot trong cÃ¡c tÃ i khoáº£n nÃ y Ä‘á»ƒ nÃ³ liÃªn tá»¥c gá»­i cÃ¡c request Ä‘áº¿n server. Khiáº¿n khÃ´ng truy cáº­p Ä‘Æ°á»£c cÃ¡c dich vá»¥, &hellip;</p>
<h4 id="common-access-control-vulnerabilities-cÃ¡c-lá»—-há»•ng-kiá»ƒm-soÃ¡t-truy-cáº­p-phá»•-biáº¿n">Common Access Control Vulnerabilities (CÃ¡c lá»— há»•ng kiá»ƒm soÃ¡t truy cáº­p phá»• biáº¿n)</h4>
<ul>
<li>Vertical Privilege Escalation:</li>
</ul>
<p>VÃ­ dá»¥ vá» cÃ¡c cuá»™c táº¥n cÃ´ng leo thang Ä‘áº·c quyá»n theo chiá»u dá»c tá»« cÃ¡c kiá»ƒm soÃ¡t truy cáº­p theo chiá»u dá»c bá»‹ há»ng bao gá»“m:</p>
<pre><code>+ Chá»©c nÄƒng nháº¡y cáº£m khÃ´ng Ä‘Æ°á»£c báº£o vá»‡

+ CÃ¡c cuá»™c táº¥n cÃ´ng dá»±a trÃªn tham sá»‘

+ Kiá»ƒm soÃ¡t truy cáº­p bá»‹ há»ng do Ä‘á»‹nh cáº¥u hÃ¬nh sai ná»n táº£ng
</code></pre>
<ul>
<li>
<p>Horizontal Privilege Escalation : cho phÃ©p ngÆ°á»i dÃ¹ng á»©ng dá»¥ng khÃ¡c nhau truy cáº­p cÃ¡c loáº¡i tÃ i nguyÃªn tÆ°Æ¡ng tá»±. CÃ¡c cÆ¡ cháº¿ nÃ y chá»‰ háº¡n cháº¿ quyá»n truy cáº­p vÃ o tÃ i nguyÃªn Ä‘á»‘i vá»›i nhÃ³m ngÆ°á»i dÃ¹ng Ä‘Æ°á»£c phÃ©p truy cáº­p tÃ i nguyÃªn. VÃ­ dá»¥: má»™t á»©ng dá»¥ng ngÃ¢n hÃ ng cho phÃ©p khÃ¡ch hÃ ng xem há»“ sÆ¡ giao dá»‹ch cá»§a há» nhÆ°ng khÃ´ng cho phÃ©p ngÆ°á»i dÃ¹ng khÃ¡c xem. Kiá»ƒm soÃ¡t truy cáº­p ngang bá»‹ há»ng cho phÃ©p káº» táº¥n cÃ´ng truy cáº­p tÃ i nguyÃªn thuá»™c vá» ngÆ°á»i dÃ¹ng khÃ¡c vÃ  do kiá»ƒm soÃ¡t ID khÃ´ng Ä‘Ãºng.</p>
</li>
<li>
<p>Context-Dependent Privilege Escalation :</p>
<p>Má»™t sá»‘ cuá»™c táº¥n cÃ´ng leo thang Ä‘áº·c quyá»n phá»¥ thuá»™c vÃ o ngá»¯ cáº£nh bao gá»“m:</p>
<ul>
<li>
<p>Insecure Direct Object Reference : Tham chiáº¿u Ä‘á»‘i tÆ°á»£ng trá»±c tiáº¿p khÃ´ng an toÃ n</p>
</li>
<li>
<p>Multi-step attacks Táº¥n cÃ´ng nhiá»u bÆ°á»›c</p>
</li>
<li>
<p>Attacks on referer-based mechanisms :CÃ¡c cuá»™c táº¥n cÃ´ng vÃ o cÃ¡c cÆ¡ cháº¿ dá»±a trÃªn giá»›i thiá»‡u</p>
</li>
<li>
<p>Attacks on geographical location-based mechanisms :Táº¥n cÃ´ng vÃ o cÆ¡ cháº¿ dá»±a trÃªn vá»‹ trÃ­ Ä‘á»‹a lÃ½</p>
</li>
</ul>
</li>
</ul>
<h3 id="preventing-broken-access-control-vulnerabilities">Preventing Broken Access Control Vulnerabilities</h3>
<p>Kiá»ƒm soÃ¡t truy cáº­p bá»‹ há»ng lÃ  má»™t lá»— há»•ng Ä‘Æ°á»£c xáº¿p háº¡ng cao trong danh sÃ¡ch OWASP Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ lÃ  thá»‰nh thoáº£ng xáº£y ra, cÃ³ kháº£ nÄƒng khai thÃ¡c trung bÃ¬nh vÃ  cÃ³ tÃ¡c Ä‘á»™ng cá»±c ká»³ sÃ¢u sáº¯c vÃ  cÃ³ háº¡i.</p>
<p>Cho nÃªn chÃºng ta cáº§n pháº£i ngÄƒn cháº·n lá»— há»•ng nÃ y, sau Ä‘Ã¢y 1 vÃ i phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ ngÄƒn cháº·n cÃ¡c cuá»™c táº¥n cÃ´ng kiá»ƒm soÃ¡t truy cáº­p.</p>
<pre><code>+ Deny by Default : Má»™t nguyÃªn táº¯c chung vá»›i kiá»ƒm soÃ¡t truy cáº­p lÃ  báº¯t Ä‘áº§u vá»›i cÃ¡c chá»©c nÄƒng Ä‘áº·c
quyá»n tá»‘i thiá»ƒu Ä‘Æ°á»£c yÃªu cáº§u. VÃ­ dá»¥: theo máº·c Ä‘á»‹nh, má»i ngÆ°á»i dÃ¹ng cá»§a á»©ng dá»¥ng sáº½ bá»‹ tá»« chá»‘i 
quyá»n truy cáº­p vÃ o tÃ i nguyÃªn á»©ng dá»¥ng, chá»‰ ngÆ°á»i dÃ¹ng há»£p phÃ¡p má»›i cÃ³ quyá»n xem, truy cáº­p vÃ  sá»­a
Ä‘á»•i chÃºng. NgoÃ i ra, cÃ¡c nhÃ³m báº£o máº­t nÃªn xÃ³a quyá»n quáº£n trá»‹ vÃ  cÃ¡c Ä‘áº·c quyá»n nÃ¢ng cao khÃ¡c, giáº£m pháº¡m vi áº£nh hÆ°á»Ÿng khi káº» táº¥n cÃ´ng cÃ³ Ä‘Æ°á»£c thÃ´ng tin Ä‘Äƒng nháº­p cá»§a ngÆ°á»i dÃ¹ng. Quáº£n lÃ½ phiÃªn cÅ©ng nÃªn Ä‘Æ°á»£c thá»±c hiá»‡n báº±ng cÃ¡ch sá»­ dá»¥ng truy cáº­p Just in Time Ä‘á»ƒ loáº¡i bá» nhu cáº§u vá» cÃ¡c Ä‘áº·c quyá»n liÃªn tá»¥c mÃ  tin táº·c cÃ³ thá»ƒ nhanh chÃ³ng láº¥y Ä‘Æ°á»£c.

+ Central Interface for Application-wide Access Controls : Pháº£i cÃ³ má»™t giao diá»‡n trung tÃ¢m, Ä‘Æ°á»£c quáº£n lÃ½ Ä‘á»ƒ ghi láº¡i cÃ¡c sÆ¡ Ä‘á»“ kiá»ƒm soÃ¡t truy cáº­p Ä‘Æ°á»£c sá»­ dá»¥ng vÃ  há»— trá»£ trong viá»‡c thiáº¿t káº¿ má»™t khuÃ´n khá»• Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ kiá»ƒm tra sá»± thÃ nh cÃ´ng cá»§a cÃ¡c cÆ¡ cháº¿ kiá»ƒm soÃ¡t truy cáº­p Ä‘Ã£ thiáº¿t láº­p.

+ Handle Access Controls At Server-Side : CÃ¡c tá»• chá»©c chá»‰ nÃªn tin tÆ°á»Ÿng xÃ¡c thá»±c vÃ  á»§y quyá»n phÃ­a mÃ¡y chá»§ vÃ¬ tá»• chá»©c Ã¡p dá»¥ng cÃ¡c biá»‡n phÃ¡p kiá»ƒm soÃ¡t giá»‘ng nhau cho táº¥t cáº£ cÃ¡c dá»‹ch vá»¥, ngÆ°á»i dÃ¹ng vÃ  á»©ng dá»¥ng. CÃ¡c nhÃ³m báº£o máº­t vÃ  nhÃ  phÃ¡t triá»ƒn nÃªn phÃ¡t triá»ƒn má»™t khuÃ´n máº«u Ä‘á»ƒ phÃ¢n tÃ¡ch cÃ¡c nhiá»‡m vá»¥.

+ Constant Testing and Auditing of Access Controls : Äiá»u quan trá»ng lÃ  lÃ m cho viá»‡c kiá»ƒm tra báº£o máº­t trá»Ÿ thÃ nh má»™t quy trÃ¬nh liÃªn tá»¥c, nháº¥t quÃ¡n báº±ng cÃ¡ch liÃªn tá»¥c kiá»ƒm tra vÃ  Ä‘Ã¡nh giÃ¡ cÃ¡c cÆ¡ cháº¿ kiá»ƒm soÃ¡t truy cáº­p Ä‘á»ƒ Ä‘áº£m báº£o chÃºng hoáº¡t Ä‘á»™ng nhÆ° dá»± Ä‘á»‹nh. NgoÃ i ra, kiá»ƒm tra hiá»‡u quáº£ giÃºp cÃ¡c nhÃ³m xÃ¡c Ä‘á»‹nh cÃ¡c lá»— há»•ng vÃ  lá»— há»•ng má»›i hÆ¡n khi chÃºng xuáº¥t hiá»‡n, nÃ¢ng cao sá»± tá»± tin cá»§a tá»• chá»©c trong viá»‡c triá»ƒn khai kiá»ƒm soÃ¡t truy cáº­p cá»§a há».

+ Clean Code with Binary Access Controls : Má»i nhÃ  phÃ¡t triá»ƒn pháº£i Ä‘áº£m báº£o ráº±ng mÃ£ nguá»“n cá»§a há» bao gá»“m cÃ¡c quy táº¯c khai bÃ¡o quyá»n truy cáº­p cho má»i tÃ i nguyÃªn á»Ÿ cáº¥p mÃ£ vÃ  quyá»n truy cáº­p pháº£i bá»‹ tá»« chá»‘i theo máº·c Ä‘á»‹nh. Äiá»u quan trá»ng ná»¯a lÃ  sá»­ dá»¥ng cÃ¡c phÆ°Æ¡ng phÃ¡p mÃ£ hÃ³a an toÃ n Ä‘á»ƒ trÃ¡nh cÃ¡c lá»—i láº­p trÃ¬nh phá»• biáº¿n mÃ  nhá»¯ng káº» táº¥n cÃ´ng nháº¯m má»¥c tiÃªu Ä‘á»ƒ truy cáº­p Ä‘áº·c quyá»n.

+ Enable RBAC : Kiá»ƒm soÃ¡t truy cáº­p dá»±a trÃªn vai trÃ² (RBAC) cho phÃ©p cÃ¡c tá»• chá»©c nhanh chÃ³ng triá»ƒn khai kiá»ƒm soÃ¡t truy cáº­p báº±ng cÃ¡ch nhÃ³m ngÆ°á»i dÃ¹ng vÃ o cÃ¡c vai trÃ² vÃ  xÃ¡c Ä‘á»‹nh cÃ¡c quyá»n liÃªn quan Ä‘áº¿n tá»«ng vai trÃ². Vá»›i RBAC, cÃ¡c nhÃ³m báº£o máº­t cÃ³ thá»ƒ giáº£m bá»›t cÃ´ng viá»‡c há»— trá»£ vÃ  quáº£n trá»‹ CNTT, tá»‘i Ä‘a hÃ³a hiá»‡u quáº£ hoáº¡t Ä‘á»™ng vÃ  cáº£i thiá»‡n sá»± tuÃ¢n thá»§ thÃ´ng qua quáº£n lÃ½ truy cáº­p dá»¯ liá»‡u.

+ Enforce Record Ownership : CÃ¡c tá»• chá»©c nÃªn láº­p mÃ´ hÃ¬nh kiá»ƒm soÃ¡t quyá»n truy cáº­p liÃªn káº¿t tá»«ng báº£n ghi vá»›i User ID cá»§a tÃ i khoáº£n Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c tÃ¡c vá»¥, thay vÃ¬ cho phÃ©p ngÆ°á»i dÃ¹ng truy cáº­p, sá»­a Ä‘á»•i, cáº­p nháº­t hoáº·c xÃ³a báº¥t ká»³ báº£n ghi nÃ o.
</code></pre>
<h3 id="portswigger-lab">PortSwigger Lab</h3>
<h3 id="lab-unprotected-admin-functionality">Lab: Unprotected admin functionality</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab has an unprotected admin panel.
Solve the lab by deleting the user carlos. 
</code></pre></div><p>MÃ´ táº£ Ä‘Ã£ khÃ¡ lÃ  khÃ³ rÃ ng, bÃ i lab nÃ y admin panel khÃ´ng Ä‘Æ°á»£c báº£o vá»‡ Ä‘iá»u Ä‘Ã³ táº¡o cÆ¡ Ä‘iá»u kiá»‡n cho cÃ¡c hacker truy cáº­p vÃ o admin vÃ  thao tÃºng quyá»n cá»§a admin. Trong bÃ i lab nÃ y thÃ¬ chÃºng ta xÃ³a acc Carlos lÃ  sáº½ Ä‘Æ°á»£c tÃ­nh hoÃ n thÃ nh.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unprotected_blog.txt.png?raw=true" alt="img"></p>
<p>Äáº§u tiÃªn truy cáº­p vÃ o lab ta sáº½ tháº¥y Ä‘Æ°á»£c 1 website bÃ¡n hÃ ng, tuy nhiÃªn dá»±a vÃ o lá»i gá»i Ã½ cá»§a Ä‘á» bÃ i lÃ  sáº½ cÃ³ admin panel tuy nhiÃªn url nhÆ° nÃ o thÃ¬ láº¡i chÆ°a biáº¿t, nÃªn chÃºng ta sáº½ gá»i 1 siÃªu tháº§n thÃº web Ä‘Ã³ lÃ  robots.txt Ä‘á»ƒ xÃ¡c Ä‘á»‹nh xem cÃ³ gÃ¬ hay :laught:
/robots.txt</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unprotected_robots.txt.png?raw=true" alt="img"></p>
<p>ChÃ  chÃ  chÃ  cÃ³ thÃªm url /administrator-panel á»Ÿ Ä‘Ã¢y nÃªn chÃºng ta thá»­ truy cáº­p vÃ o url nÃ y xem sao, thÃ¬ tháº­t báº¥t ngá» vÃ´ luÃ´n :| Ä‘Æ¡n giáº£n lÃ  gÃ¬ lab Ä‘Ã£ nÃ³i lÃ  unprotected rá»“i mÃ  :vv</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unprotected_admin_pale.png?raw=true" alt="img"></p>
<p>Sau Ä‘Ã³ chÃºng ta chá»‰ cáº§n xÃ³a acc lÃ  solve lab thÃ´i :D</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unprotected_deleteCarrlos.png?raw=true" alt="img"></p>
<h3 id="lab-unprotected-admin-functionality-with-unpredictable-url">Lab: Unprotected admin functionality with unpredictable URL</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab has an unprotected admin panel. It&#39;s located at an unpredictable location, but the location is disclosed somewhere in the application.
Solve the lab by accessing the admin panel, and using it to delete the user carlos. 
</code></pre></div><p>Láº§n nÃ y lab cÅ©ng khÃ´ng Ä‘Æ°á»£c báº£o vá»‡, tuy nhiÃªn url cá»§a bÃ i nÃ y láº¡i Ä‘Æ°á»£c giáº¥u á»Ÿ Ä‘Ã¢u Ä‘Ã³ trong trang web, tá»©c lÃ  khÃ´ng pháº£i siÃªu tháº§n thÃº ná»¯a rá»“i, pháº£i dÃ¹ng cÃ¡ch khÃ¡c thÃ´i :&laquo;</p>
<p>Truy cáº­p tiáº¿p vÃ o bÃ i lab chÃºng tha sáº½ tháº¥y giao diá»‡n chÃ­nh cá»§a lab lÃ  1 trang web bÃ¡n hÃ ng nhÆ° sau :</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredict_shop.png?raw=true" alt="img"></p>
<p>Sau Ä‘Ã³ vÃ¬ gá»£i Ã½ lÃ  nÄƒm trong web nÃªn ta sáº½ kiá»ƒm tra source code cá»§a web báº±ng view page source :3</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredict_source.png?raw=true" alt="img"></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var isAdmin = false;
if (isAdmin) {
   var topLinksTag = document.getElementsByClassName(&#34;top-links&#34;)[0];
   var adminPanelTag = document.createElement(&#39;a&#39;);
   adminPanelTag.setAttribute(&#39;href&#39;, &#39;/admin-6cr3fx&#39;);
   adminPanelTag.innerText = &#39;Admin panel&#39;;
   topLinksTag.append(adminPanelTag);
   var pTag = document.createElement(&#39;p&#39;);
   pTag.innerText = &#39;|&#39;;
   topLinksTag.appendChild(pTag);
}
</code></pre></div><p>VÃ  chÃºng tháº¥y Ä‘Æ°á»£c Ä‘oáº¡n js nhÆ° sau, Ä‘oáº¡n nÃ y Ä‘ang kiá»ƒm tra xem ngÆ°á»i dÃ¹ng cÃ³ pháº£i admin hay khÃ´ng
vÃ  sau Ä‘Ã³ nháº£y Ä‘áº¿n url /admin-6cr3fx Ä‘á»ƒ truy cáº­p admin panel, tuy nhiÃªn vÃ¬ khÃ´ng cÃ³ cÆ¡ cháº¿ báº£o vá»‡ nÃªn
chÃºng ta cÃ³ thá»ƒ truy cáº­p vÃ o admin panel thá»§ cÃ´ng báº±ng cÃ¡ch gá»i url.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredict_delCarlos.png?raw=true" alt="img"></p>
<p>Truy cáº­p vÃ o vÃ  xÃ³a acc Carlos Ä‘á»ƒ hoÃ n thÃ nh yÃªu cáº§u cá»§a bÃ i lab nÃ y :3</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredict_adminpanel.png?raw=true" alt="img"></p>
<h3 id="lab-user-role-controlled-by-request-parameter">Lab: User role controlled by request parameter</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab has an admin panel at /admin, which identifies administrators using a forgeable cookie.

Solve the lab by accessing the admin panel and using it to delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter
</code></pre></div><p>BÃ i nÃ y cho sáºµn panel tuy nhiÃªn Ä‘Ã£ sá»­ dá»¥ng cookie Ä‘á»ƒ phÃ¢n biá»‡t tháº±ng nÃ o lÃ  admin tháº±ng nÃ o lÃ  user rÃ²i, nÃªn khÃ´ng cÃ³ chuyá»‡n Ä‘i Ä‘Æ°á»ng Ä‘Æ°á»ng chÃ­nh chÃ­nh vÃ o admin panel Ä‘Æ°á»£c ná»¯a pháº£i chÆ¡i chiÃªu thÃ´i :3</p>
<p>Truy cáº­p vÃ o láº¡i tháº¥y cÃ¡i shop nhÆ° nÃ y vÃ  login vÃ o vá»›i acc Ä‘Ã£ Ä‘Æ°á»£c cáº¥p tá»« trÆ°á»›c :</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_requestparameter_shop.png?raw=true" alt="img">
Nháº£y vÃ´ admin panel thÃ¬ nÃ³ Ä‘áº­p cho cÃ¡i dÃ²ng nÃ y vÃ´ máº·t :|</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Admin interface only available if logged in as an administrator 
</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_requestparameter_checkadmin.png?raw=true" alt="img"></p>
<p>Theo nhÆ° kinh nghiá»‡m tÃ­ch tá»¥ lÃ¢u nay thÃ¬ rÃµ rÃ ng lÃ  trong request Ä‘Ã£ cÃ³ cookie session Ä‘á»ƒ phÃ¢n biÃªt cÃ³ pháº£i admin hay khÃ´ng rá»“i</p>
<p>NÃªn chÃºng ta dÃ¹ng BurpSuite báº¯t request xem thá»­ nhÆ° nÃ o</p>
<p>Báº¥t ngá» chÆ°a cÃ¡i admin nÃ³ rÃµ rÃ ng luÃ´n kÃ¬a admin=false lÃ  quyá»n háº¡n cá»§a weiner nÃªn lÃ  muá»‘n upgrade lÃªn admin thÃ¬ chá»‰nh láº¡i true thÃ´i</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_requestparameter_adminpanel.png?raw=true" alt="img"></p>
<p>NhÆ° sau thÃ¬ cÃ³ thá»ƒ tháº¥y chÃºng ta Ä‘Ã£ vÃ o Ä‘c admin panel</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_requestparameter_delCarrlos.png?raw=true" alt="img"></p>
<p>XÃ³a carlos vÃ  solveeeeeeee</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_requestparameter_solve.png?raw=true" alt="img"></p>
<h3 id="lab-user-role-can-be-modified-in-user-profile">Lab: User role can be modified in user profile</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"> This lab has an admin panel at /admin. It&#39;s only accessible to logged-in users with a roleid of 2.
Solve the lab by accessing the admin panel and using it to delete the user carlos.
You can log in to your own account using the following credentials: wiener:peter 
</code></pre></div><p>BÃ i nÃ y thÃ¬ láº¡i cho tiáº¿p Ä‘Æ°á»ng url /admin tuy nhiÃªn láº§n nÃ y admin sáº½ Ä‘Æ°á»£c Ä‘á»‹nh dáº¡ng báº±ng roleid = 2 . Tháº¿ cháº¯c cÃº lÃ  roleid cá»§a acc count Ä‘c cáº¥p lÃ  khÃ¡c 2 rá»“i :|</p>
<p>Tuy cáº­p vÃ o lab cÃ¹ng account Ä‘Æ°á»£c cáº¥p sau Ä‘Ã³ truy cáº­p admin panel thÃ¬ váº«n dÃ²ng chá»¯ quen thuá»™c tuy nhiÃªn mÃ¬nh Ä‘Ã£ liáº¿c máº¯t soi mÃ³i thá»­ xem roleid nÃ³ á»Ÿ Ä‘Ã¢u trong cÃ¡i request admin panel nhÆ°ng láº¡i khÃ´ng cÃ³ :|</p>
<p>Tháº¿ lÃ  mÃ¬nh Ä‘oÃ¡n ráº±ng nÃ³ náº±m Ä‘Ã¢u Ä‘Ã³ trong profile cá»§a account rá»“i tuy nhiÃªn mÃ¬nh Ä‘ang á»Ÿ url /my-account rá»“i mÃ  cÃ³ tháº¥y gÃ¬ Ä‘Ã¢u ?? NhÆ°ng láº¡i cÃ³ chá»©c nÄƒng change email nÃªn mÃ¬nh test thá»­ vÃ  báº¯t request láº¡i thÃ¬ nÃ³ nhÆ° nÃ y nÃ y :</p>
<p>CÃ³ pháº£i rÃµ rÃ ng quÃ¡ rá»“i khÃ´ng, theo nhÆ° cÃº phÃ¡p trÃªn request Ä‘á»ƒ change email thÃ¬ chÃºng ta maybeeeeeee cÃ³ thá»ƒ change roleid nhi ?? suy nghÄ© há»£p lÃ½ mÃ  :|</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_usserprofile_changeroleid.png?raw=true" alt="img"></p>
<p>MÃ  há»£p lÃ½ thÃ¬ thá»­ thÃ´i.</p>
<p>Thá»­ chÆ¡i chÆ¡i ai ngá» Ä‘Æ°á»£c tháº­t, tháº­t ra Ä‘Ã¢y lÃ  do cÆ¡ cháº¿ update csdl cá»§a website nÃªn viá»‡c mÃ¬nh update roleid lÃ  1 trong nhá»¯ng &ldquo;tÃ­nh nÄƒng&rdquo; khÃ´ng mong muá»‘n cá»§a dev thÃ´i ğŸš‘</p>
<p>VÃ¬ mÃ¬nh Ä‘Ã£ thay Ä‘á»•i roleid nÃªn lÃ  viá»‡c truy cáº­p admin panel Ä‘á»ƒ xÃ³a lÃ  hoÃ n toÃ n Ä‘Æ°á»£c phÃ©p ğŸ¤ ğŸ¤ ğŸ¤ ğŸ¤ </p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_usserprofile_adminpanel.png?raw=true" alt="img"></p>
<p>Solve Ä‘i nÃ o</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_usserprofile_deleteacc.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_usserprofile_solve.png?raw=true" alt="img"></p>
<h3 id="lab-url-based-access-control-can-be-circumvented">Lab: URL-based access control can be circumvented</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This website has an unauthenticated admin panel at /admin, but a front-end system has been configured to block external access to that path. However, the back-end application is built on a framework that supports the X-Original-URL header.

To solve the lab, access the admin panel and delete the user carlos.
</code></pre></div><p>Láº§n nÃ y láº¡i lÃ  1 sá»± thay Ä‘á»•i nho nhá» Ä‘Ã³ chÃ­nh lÃ  láº§n nÃ y lab Ä‘Ã£ sá»­ dá»¥ng framework X-Original-URL, vá» cÆ¡ cháº¿ nÃ y thÃ¬ Ä‘á»‘i vá»›i cÃ¡c phÆ°Æ¡ng thá»©c POST sáº½ deny nhá»¯ng url nhÆ° lÃ  /admin, /delete ,&hellip;.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_circumvented_adminpanel.png?raw=true" alt="img"></p>
<p>Test thá»­ cÃ¡i web thÃ¬ y nhÆ° ráº±ng, tá»« chá»‘i cÃ¡i nhe. Tuy nhiÃªn khi thá»­ format cá»§a X-Original-URL thÃ¬ tháº¥y ráº±ng chÃºng ta Ä‘Ã£ truy cáº­p Ä‘Æ°á»£c vÃ o admin panel Ã¨o Ã¨o Ã¨o</p>
<p>Tháº¿ lÃ  chÃºng ta chá»‰ viá»‡c xÃ³a Carlos nhÆ° sau ğŸš‘ğŸš‘ğŸš‘ğŸš‘</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_circumvented_dellCarlos.png?raw=true" alt="img"></p>
<p>Solveee</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_circumvented_solve.png?raw=true" alt="img"></p>
<h3 id="lab-method-based-access-control-can-be-circumvented">Lab: Method-based access control can be circumvented</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab implements access controls based partly on the HTTP method of requests. You can familiarize yourself with the admin panel by logging in using the credentials administrator:admin.

To solve the lab, log in using the credentials wiener:peter and exploit the flawed access controls to promote yourself to become an administrator.
</code></pre></div><pre><code>![img](https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_accescircumvented_adminpanel.png?raw=true)
</code></pre>
<h3 id="lab-user-id-controlled-by-request-parameter">Lab: User ID controlled by request parameter</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab has a horizontal privilege escalation vulnerability on the user account page.

To solve the lab, obtain the API key for the user carlos and submit it as the solution.

You can log in to your own account using the following credentials: wiener:peter
</code></pre></div><p>Vá» bÃ i lab nÃ y chÃºng ta sáº½ Ä‘Æ°á»£c tiáº¿p cáº­n tá»›i 1 phong cÃ¡ch leo thang Ä‘áº·c quyá»n khÃ¡c, Ä‘Ã³ chÃ­nh lÃ  leo thang Ä‘áº·c quyá»n theo chiá»u ngang ğŸ˜†ğŸ˜†ğŸ˜† hay nÃ³i 1 cÃ¡ch khÃ¡c báº¡n sáº½ chiáº¿m Ä‘Æ°á»£c Ä‘áº·c quyá»n cá»§a 1 account cÃ¹ng cáº¥p vá»›i account cá»§a mÃ¬nh .</p>
<p>Äá»ƒ giáº£i quyáº¿t bÃ i lab thÃ¬ pháº£i láº¥y Ä‘Æ°á»£c API key tá»« accont carlos .</p>
<p>Truy cáº­p vÃ  login vÃ o acc wiener chÃºng ta cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c API key, tuy nhiÃªn thá»© chÃºng ta cáº§n láº¡i lÃ  API Key cá»§a carlos</p>
<p>Thá»­ báº¯t cÃ¡c request cá»§a website Ä‘á»ƒ tÃ¬m ra Ä‘iá»u Ä‘áº·c biá»‡t, thÃ¬ phÃ¡t hiá»‡n ra khi tá»« home page request sang myaccount Ä‘Ã£ sá»­ dá»¥ng parameter id = ?</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_idcontroler_requestwiener.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_idcontroler_carlos.png?raw=true" alt="img"></p>
<p>Lá»£i dá»¥ng viá»‡c Ä‘Ã³ chÃºng ta thay Ä‘á»•i wiener thÃ nh carlos vÃ  chÃºng ta Ä‘Ã£ khai thÃ¡c leo thang Ä‘áº·c quyá»n theo chiá»u ngang.</p>
<p>Submit API key Ä‘á»ƒ solve.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_idcontroler_submit.png?raw=true" alt="img"></p>
<pre><code>![img](https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_idcontroler_solve.png?raw=true)
</code></pre>
<h3 id="lab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids">Lab: User ID controlled by request parameter, with unpredictable user IDs</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab has a horizontal privilege escalation vulnerability on the user account page, but identifies users with GUIDs.

To solve the lab, find the GUID for carlos, then submit his API key as the solution.

You can log in to your own account using the following credentials: wiener:peter
</code></pre></div><pre><code>Láº§n nÃ y thÃ¬ chÃºng ta sáº½ tráº£i nghiá»‡m 1 cÆ¡ cháº¿ Ä‘á»ƒ Ä‘á»‹nh danh ngÆ°á»i dÃ¹ng khÃ¡c Ä‘Ã³ chÃ­nh lÃ  GUIDs.
</code></pre>
<p>Äá»ƒ hoÃ n thÃ nh bÃ i lab chÃºng ta cáº§n leak Ä‘Æ°á»£c GUIDs cá»§a carlos vÃ  submit.</p>
<p>Äáº·c Ä‘iá»ƒm cá»§a GUIDs lÃ  dÃ¹ng Ä‘á»ƒ Ä‘á»‹nh danh cho user , tuy nhiÃªn thÃ¬ cÅ©ng Ä‘á»‹nh danh cho cÃ¡c bÃ i viáº¿t hoáº·c comment nÃªn chÃºng ta cÃ³ thá»ƒ dá»±a vÃ o Ä‘Ã³ Ä‘á»ƒ tÃ¬m kiáº¿m khi lab cho chÃºng ta 1 blog nhÆ° sau  :</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredictable_blog.png?raw=true" alt="img"></p>
<p>TÃ¬m kiáº¿m carlos blog vÃ  truy cáº­p báº¯t request Ä‘á»ƒ leak id</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredictable_blogcarlos.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredictable_carlosid.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredictable_changeidcarlos.png?raw=true" alt="img"></p>
<p>Sau Ä‘Ã³ sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p nhÆ° lab trÃªn Ä‘á»ƒ truy cáº­p vÃ o carlos account leak API Key</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredictable_carlosapikey.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_unpredictable_solve.png?raw=true" alt="img"></p>
<h3 id="lab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect">Lab: User ID controlled by request parameter with data leakage in redirect</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab contains an access control vulnerability where sensitive information is leaked in the body of a redirect response.

To solve the lab, obtain the API key for the user carlos and submit it as the solution.

You can log in to your own account using the following credentials: wiener:peter
</code></pre></div><p>BÃ i nÃ y lÃ  1 dáº¡ng bÃ i chuyá»ƒn hÆ°á»›ng phá»• thÃ´ng, chÃºng ta hoÃ n toÃ n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡ch Ä‘Ã£ lÃ m vá»›i bÃ i <em>Lab: User ID controlled by request parameter</em> Ä‘á»ƒ Ã¡p dá»¥ng vÃ o, nhÆ° v lÃ  cÃ³ thá»ƒ giáº£i quyáº¿t bÃ i nÃ y rá»“i :3</p>
<h3 id="lab-user-id-controlled-by-request-parameter-with-password-disclosure">Lab: User ID controlled by request parameter with password disclosure</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab has user account page that contains the current user&#39;s existing password, prefilled in a masked input.

To solve the lab, retrieve the administrator&#39;s password, then use it to delete carlos.

You can log in to your own account using the following credentials: wiener:peter
</code></pre></div><p>Äá» bÃ i Ä‘Ã£ gá»£i Ã½ ráº±ng ngay pháº§n account sáº½ cÃ³ pháº§n cho tháº¥y Ä‘Æ°á»£c password cá»§a ngÆ°á»i dÃ¹ng, Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a ráº±ng náº¿u chÃºng ta cÃ³ thá»ƒ truy cáº­p báº±ng id=administrator thÃ¬ cÃ³ thá»ƒ leak Ä‘Æ°á»£c password cá»§a admin rá»“i.</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_passdis_requestwiener.png?raw=true" alt="img"></p>
<p>Váº­y chÃºng ta lÃ m tÆ°Æ¡ng tá»± nhá»¯ng lab trÆ°á»›c , báº¯t cÃ¡c request láº¡i Ä‘á»ƒ kiá»ƒm tra vÃ  khai thÃ¡c nhÆ° sau :</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_passdis_requestadmin.png?raw=true" alt="img"></p>
<p>Leak Ä‘Æ°á»£c password nhÆ° sau</p>
<p>pwd = rektc1zrs99g9wav0gmg</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_passdis_adminacc.png?raw=true" alt="img"></p>
<p>Truy cáº­p vÃ o admin panel Ä‘á»ƒ xÃ³a account Carlos Ä‘á»ƒ sovle</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_passdis_adminpanel.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_passdis_solve.png?raw=true" alt="img"></p>
<h3 id="lab-insecure-direct-object-references">Lab: Insecure direct object references</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab stores user chat logs directly on the server&#39;s file system, and retrieves them using static URLs.

Solve the lab by finding the password for the user carlos, and logging into their account.
</code></pre></div><p>BÃ i nÃ y Ä‘áº·c biá»‡t hÆ¡n, chá»‰ lÃ  sá»­ dá»¥ng log Ä‘á»ƒ ghi láº¡i cÃ¡c cuá»™c live chat , Ä‘á»ƒ bÃ i yÃªu cáº§u chÃºng ta tÃ¬m kiá»ƒm Ä‘Ã¢u Ä‘Ã³ trong live chat tÃ¬m ra password cá»§a carlos</p>
<p>Ta tháº¥y Ä‘Æ°á»£c chá»©c nÄƒng live chat nhÆ° sau :</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_insecure_livechat.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_insecure_viewscrip%5Bt.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_insecure_viewscrip%5Bt11.png?raw=true" alt="img"></p>
<p>CÃ³ chá»©c nÄƒng view transcript báº¯t láº¡i request thÃ¬ chÃºng ta tháº¥y Ä‘Æ°á»£c nÃ³ sáº½ load láº¡i Ä‘oáº¡n chat vá»«a rá»“i vá», tuy nhiÃªn láº¡i tháº¥y ffile lÃ  2.txt Ä‘iá»u Ä‘Ã³ cÃ³ nghÄ©a lÃ  1.txt lÃ  Ä‘oáº¡n trÃ² chuyá»‡n trÆ°á»›c Ä‘Ã³.</p>
<p>Thay Ä‘á»•i 1.txt Ä‘á»ƒ load vá», Ä‘á»c Ä‘Æ°á»£c Ä‘oáº¡n chat trong file log, chÃºng ta cÃ³ Ä‘Æ°á»£c password cá»§a carlos vÃ  login</p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_insecure_logincarlos.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_insecure_solve.png?raw=true" alt="img"></p>
<h3 id="lab-multi-step-process-with-no-access-control-on-one-step">Lab: Multi-step process with no access control on one step</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab has an admin panel with a flawed multi-step process for changing a user&#39;s role. You can familiarize yourself with the admin panel by logging in using the credentials administrator:admin.

To solve the lab, log in using the credentials wiener:peter and exploit the flawed access controls to promote yourself to become an administrator.
</code></pre></div><p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_noonestep_admin.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_noonestep_admin_confirm.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_noonestep_wiener.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_noonestep_wiener_request.png?raw=true" alt="img"></p>
<p><img src="https://github.com/datnlq/Source/blob/main/AccessControl/image/Actrl_noonestep_exploit.png?raw=true" alt="img"></p>
<h3 id="referer-based-access-control">Referer-based access control</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">This lab controls access to certain admin functionality based on the Referer header. You can familiarize yourself with the admin panel by logging in using the credentials administrator:admin.

To solve the lab, log in using the credentials wiener:peter and exploit the flawed access controls to promote yourself to become an administrator.
</code></pre></div><pre><code>Solveeeeee ezzz gemm
</code></pre>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
